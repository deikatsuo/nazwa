{{ template "base" .}} {{ define "dashboard_orders_add_content" }}
<h2 class="my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200">
  Buat Order
</h2>

<div class="grid gap-6 mb-8">
  <!-- Produk baru -->
  <div class="p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
    <div x-data="create()" id="create">
      <div x-show="!orderCreated">
        <!-- Konsumen -->
        <div class="w-full relative md:w-2/3 md:px-1">
          <label class="block mt-4 text-sm">
            <span class="text-gray-700 dark:text-gray-400">Konsumen</span>
            <input
              class="block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-gray-100 focus:outline-none focus:shadow-md dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
              placeholder="Nomor Induk Kependudukan (NIK)"
              x-model="instantData.customer"
              @keyup="if (instantData.customer.length > 5 && instantData.customer.length <= 16) { closeCustomerIS = false; searchNIK(); } else { closeCustomerIS = true; }"
              @click="if (instantData.customer.length > 5 && instantData.customer.length <= 16) { closeCustomerIS = false; } else { closeCustomerIS = true; }"
              @click.away="closeCustomerIS = true;"
              @keydown.tab="closeCustomerIS = true;"
              x-show="$parent.isObjEmpty(tempDataCustomer)"
              :class="{'border-red-600 focus:border-red-400 focus:outline-none focus:shadow-outline-red': errCustomer }"
            />
            <div class="w-full">
              <div
                class="relative bg-blue-400 bg-opacity-50 mt-1 text-sm inline-block py-1 pl-4 pr-8 rounded-full"
                x-show="!$parent.isObjEmpty(tempDataCustomer)"
              >
                <i
                  x-text="tempDataCustomer.Firstname +' '+ tempDataCustomer.Lastname"
                ></i>
                (<b x-text="tempDataCustomer.RIC"></b>)
                <p
                  style="margin-top: 0.42rem"
                  class="cursor-pointer absolute right-0 top-0 mr-2"
                  @click="tempDataCustomer = {};
                  formData.customer = 0;"
                >
                  {{ template "_svg_icon_close" }}
                </p>
              </div>
            </div>
          </label>
          <ul
            x-transition:leave="transition ease-in duration-150"
            x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0"
            x-show="!closeCustomerIS"
            class="absolute z-30 left-0 right-0 -mt-1 md:mr-1 md:ml-1 text-gray-600 bg-white border-none border-r border-l border-b border-gray-100 rounded-br-md rounded-bl-md shadow-md dark:border-gray-700 dark:text-gray-300 dark:bg-gray-700"
            aria-label="submenu"
          >
            <div
              x-show="customerIS.length > 0 && closeCustomerIS == false && $parent.isObjEmpty(tempDataCustomer)"
            >
              <template x-for="(customer, index) in customerIS" :key="index">
                <li class="flex">
                  <a
                    class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                    href="#"
                    tabindex="-1"
                    @click="tempDataCustomer = 
                      {
                        ID: customer.ID,
                        Firstname: customer.Firstname,
                        Lastname: customer.Lastname,
                        RIC: customer.RIC,
                      };
                      formData.customer = customer.ID;"
                  >
                    <img
                      class="object-cover w-5 h-5 rounded-full mr-3"
                      :src="'/file/profile/thumbnail/'+customer.Avatar"
                      alt=""
                      loading="lazy"
                    />
                    <span
                      x-text="customer.Firstname +' '+ customer.Lastname"
                    ></span>
                  </a>
                </li>
              </template>
            </div>
            <div x-show="customerIS.length == 0">
              <span
                class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                >Tidak ada data</span
              >
            </div>
          </ul>
        </div>

        <div class="flex flex-wrap mb-6">
          <!-- Sales -->
          <div class="w-full relative md:w-1/3 md:px-1">
            <label class="block mt-4 text-sm">
              <span class="text-gray-700 dark:text-gray-400">Sales</span>
              <input
                class="block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-gray-100 focus:outline-none focus:shadow-md dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                placeholder="Nama Sales"
                x-model="instantData.sales"
                @keyup="if (instantData.sales.length >= 3 && instantData.sales.length <= 25) { closeSalesIS = false; searchSales(); } else { closeSalesIS = true; }"
                @click="if (instantData.sales.length >= 3 && instantData.sales.length <= 25) { closeSalesIS = false; } else { closeSalesIS = true; }"
                @click.away="closeSalesIS = true;"
                @keydown.tab="closeSalesIS = true;"
                x-show="$parent.isObjEmpty(tempDataSales)"
                :class="{'border-red-600 focus:border-red-400 focus:outline-none focus:shadow-outline-red': errSales }"
              />
            </label>
            <div class="w-full">
              <div
                class="relative bg-blue-400 bg-opacity-50 mt-1 text-sm inline-block py-1 pl-4 pr-8 rounded-full"
                x-show="!$parent.isObjEmpty(tempDataSales)"
              >
                <i
                  x-text="tempDataSales.Firstname +' '+ tempDataSales.Lastname"
                ></i>
                (<b x-text="tempDataSales.Username"></b>)
                <p
                  style="margin-top: 0.42rem"
                  class="cursor-pointer absolute right-0 top-0 mr-2"
                  @click="tempDataSales = {};
                  formData.sales = 0;"
                >
                  {{ template "_svg_icon_close" }}
                </p>
              </div>
            </div>
            <ul
              x-transition:leave="transition ease-in duration-150"
              x-transition:leave-start="opacity-100"
              x-transition:leave-end="opacity-0"
              x-show="!closeSalesIS"
              class="absolute z-30 left-0 right-0 -mt-1 md:mr-1 md:ml-1 text-gray-600 bg-white border-none border-r border-l border-b border-gray-100 rounded-br-md rounded-bl-md shadow-md dark:border-gray-700 dark:text-gray-300 dark:bg-gray-700"
              aria-label="submenu"
            >
              <div
                x-show="salesIS.length > 0 && closeSalesIS == false && $parent.isObjEmpty(tempDataSales)"
              >
                <template x-for="(sales, index) in salesIS" :key="index">
                  <li class="flex">
                    <a
                      class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#"
                      tabindex="-1"
                      @click="tempDataSales = 
                      {
                        ID: sales.ID,
                        Firstname: sales.Firstname,
                        Lastname: sales.Lastname,
                        Username: sales.Username,
                      };
                      formData.sales = sales.ID;"
                    >
                      <img
                        class="object-cover w-5 h-5 rounded-full mr-3"
                        :src="'/file/profile/thumbnail/'+sales.Avatar"
                        alt=""
                        loading="lazy"
                      />
                      <span
                        x-text="sales.Firstname +' '+ sales.Lastname"
                      ></span>
                    </a>
                  </li>
                </template>
              </div>
              <div x-show="salesIS.length == 0">
                <span
                  class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                  >Tidak ada data</span
                >
              </div>
            </ul>
          </div>

          <!-- Surveyor -->
          <div class="w-full relative md:w-1/3 md:px-1">
            <label class="block mt-4 text-sm">
              <span class="text-gray-700 dark:text-gray-400">Surveyor</span>
              <input
                class="block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-gray-100 focus:outline-none focus:shadow-md dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                placeholder="Nama Surveyor"
                x-model="instantData.surveyor"
                @keyup="if (instantData.surveyor.length >= 3 && instantData.surveyor.length <= 25) { closeSurveyorIS = false; searchSurveyor(); } else { closeSurveyorIS = true; }"
                @click="if (instantData.surveyor.length >= 3 && instantData.surveyor.length <= 25) { closeSurveyorIS = false; } else { closeSurveyorIS = true; }"
                @click.away="closeSurveyorIS = true;"
                @keydown.tab="closeSurveyorIS = true;"
                x-show="$parent.isObjEmpty(tempDataSurveyor)"
                :class="{'border-red-600 focus:border-red-400 focus:outline-none focus:shadow-outline-red': errSurveyor }"
              />
            </label>
            <div class="w-full">
              <div
                class="relative bg-blue-400 bg-opacity-50 mt-1 text-sm inline-block py-1 pl-4 pr-8 rounded-full"
                x-show="!$parent.isObjEmpty(tempDataSurveyor)"
              >
                <i
                  x-text="tempDataSurveyor.Firstname +' '+ tempDataSurveyor.Lastname"
                ></i>
                (<b x-text="tempDataSurveyor.Username"></b>)
                <p
                  style="margin-top: 0.42rem"
                  class="cursor-pointer absolute right-0 top-0 mr-2"
                  @click="tempDataSurveyor = {};
                  formData.surveyor = 0;"
                >
                  {{ template "_svg_icon_close" }}
                </p>
              </div>
            </div>
            <ul
              x-transition:leave="transition ease-in duration-150"
              x-transition:leave-start="opacity-100"
              x-transition:leave-end="opacity-0"
              x-show="!closeSurveyorIS"
              class="absolute z-30 left-0 right-0 -mt-1 md:mr-1 md:ml-1 text-gray-600 bg-white border-none border-r border-l border-b border-gray-100 rounded-br-md rounded-bl-md shadow-md dark:border-gray-700 dark:text-gray-300 dark:bg-gray-700"
              aria-label="submenu"
            >
              <div
                x-show="surveyorIS.length > 0 && closeSurveyorIS == false && $parent.isObjEmpty(tempDataSurveyor)"
              >
                <template x-for="(surveyor, index) in surveyorIS" :key="index">
                  <li class="flex">
                    <a
                      class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#"
                      tabindex="-1"
                      @click="tempDataSurveyor = 
                      {
                        ID: surveyor.ID,
                        Firstname: surveyor.Firstname,
                        Lastname: surveyor.Lastname,
                        Username: surveyor.Username,
                      };
                      formData.surveyor = surveyor.ID;"
                    >
                      <img
                        class="object-cover w-5 h-5 rounded-full mr-3"
                        :src="'/file/profile/thumbnail/'+surveyor.Avatar"
                        alt=""
                        loading="lazy"
                      />
                      <span
                        x-text="surveyor.Firstname +' '+ surveyor.Lastname"
                      ></span>
                    </a>
                  </li>
                </template>
              </div>
              <div x-show="surveyorIS.length == 0">
                <span
                  class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                  >Tidak ada data</span
                >
              </div>
            </ul>
          </div>

          <!-- Kolektor -->
          <div class="w-full relative md:w-1/3 md:px-1">
            <label class="block mt-4 text-sm">
              <span class="text-gray-700 dark:text-gray-400">Kolektor</span>
              <input
                class="block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-gray-100 focus:outline-none focus:shadow-md dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                placeholder="Nama Kolektor"
                x-model="instantData.collector"
                @keyup="if (instantData.collector.length >= 3 && instantData.collector.length <= 25) { closeCollectorIS = false; searchCollector(); } else { closeCollectorIS = true; }"
                @click="if (instantData.collector.length >= 3 && instantData.collector.length <= 25) { closeCollectorIS = false; } else { closeCollectorIS = true; }"
                @click.away="closeCollectorIS = true;"
                @keydown.tab="closeCollectorIS = true;"
                x-show="$parent.isObjEmpty(tempDataCollector)"
                :class="{'border-red-600 focus:border-red-400 focus:outline-none focus:shadow-outline-red': errCollector }"
              />
            </label>
            <div class="w-full">
              <div
                class="relative bg-blue-400 bg-opacity-50 mt-1 text-sm inline-block py-1 pl-4 pr-8 rounded-full"
                x-show="!$parent.isObjEmpty(tempDataCollector)"
              >
                <i
                  x-text="tempDataCollector.Firstname +' '+ tempDataCollector.Lastname"
                ></i>
                (<b x-text="tempDataCollector.Username"></b>)
                <p
                  style="margin-top: 0.42rem"
                  class="cursor-pointer absolute right-0 top-0 mr-2"
                  @click="tempDataCollector = {};
                  formData.collector = 0;"
                >
                  {{ template "_svg_icon_close" }}
                </p>
              </div>
            </div>
            <ul
              x-transition:leave="transition ease-in duration-150"
              x-transition:leave-start="opacity-100"
              x-transition:leave-end="opacity-0"
              x-show="!closeCollectorIS"
              class="absolute z-30 left-0 right-0 -mt-1 md:mr-1 md:ml-1 text-gray-600 bg-white border-none border-r border-l border-b border-gray-100 rounded-br-md rounded-bl-md shadow-md dark:border-gray-700 dark:text-gray-300 dark:bg-gray-700"
              aria-label="submenu"
            >
              <div
                x-show="collectorIS.length > 0 && closeCollectorIS == false && $parent.isObjEmpty(tempDataCollector)"
              >
                <template
                  x-for="(collector, index) in collectorIS"
                  :key="index"
                >
                  <li class="flex">
                    <a
                      class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#"
                      tabindex="-1"
                      @click="tempDataCollector = 
                      {
                        ID: collector.ID,
                        Firstname: collector.Firstname,
                        Lastname: collector.Lastname,
                        Username: collector.Username,
                      };
                      formData.collector = collector.ID;"
                    >
                      <img
                        class="object-cover w-5 h-5 rounded-full mr-3"
                        :src="'/file/profile/thumbnail/'+collector.Avatar"
                        alt=""
                        loading="lazy"
                      />
                      <span
                        x-text="collector.Firstname +' '+ collector.Lastname"
                      ></span>
                    </a>
                  </li>
                </template>
              </div>
              <div x-show="collectorIS.length == 0">
                <span
                  class="inline-flex items-center w-full px-3 py-1 text-sm transition-colors duration-150 hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                  >Tidak ada data</span
                >
              </div>
            </ul>
          </div>

          <!-- Pembayaran kredit -->
          <div class="w-full md:px-1">
            <label class="block mt-4 text-sm">
              <span class="text-gray-700 dark:text-gray-400"
                >Metode Pembayaran</span
              >
              <div class="block text-xs">
                <span class="pr-3 text-green-500 dark:text-green-400"
                  >Cash</span
                >
                <div
                  class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in"
                >
                  <input
                    type="checkbox"
                    x-model="formData.credit"
                    class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"
                  />
                  <span
                    class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"
                  ></span>
                </div>
                <span class="pr-3 text-orange-500 dark:text-orange-400"
                  >Kredit</span
                >
              </div>
            </label>
          </div>

          <div class="w-full md:px-1" x-show="formData.credit == true">
            <div class="md:w-1/3">
              <label class="block mt-4 text-sm">
                <span class="text-gray-700 dark:text-gray-400"
                  >Lama Angsuran</span
                >
                <input
                  class="block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                  placeholder="Misal: 6, untuk 6 bulan"
                  x-model="formData.duration"
                  @keydown.enter="submitData($dispatch)"
                  :class="{'border-red-600 focus:border-red-400 focus:outline-none focus:shadow-outline-red': errDuration }"
                />
              </label>
              <span
                class="text-xs text-red-600 dark:text-red-400"
                x-text="errmDuration"
                :class="{'invisible': errDuration == false}"
              >
              </span>
            </div>
          </div>

          <!-- Catatan -->
          <div class="w-full md:px-1">
            <div class="md:w-2/3">
              <label class="block mt-4 text-sm">
                <span class="text-gray-700 dark:text-gray-400">Catatan</span>
                <textarea
                  class="block w-full mt-1 text-sm dark:text-gray-300 dark:border-gray-600 dark:bg-gray-700 form-textarea focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:focus:shadow-outline-gray"
                  rows="3"
                  placeholder="Catatan mengenai order!"
                  x-model="formData.notes"
                ></textarea>
              </label>
            </div>
          </div>

          <div class="w-full md:w-1/3 md:px-1">
            <label class="block mt-4 text-sm">
              <span class="text-gray-700 dark:text-gray-400">Harga Beli</span>
              <input
                class="block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                placeholder="Harga dari Pabrik"
                x-model="formData.base_price"
                @keydown.enter="submitData($dispatch)"
                :class="{'border-red-600 focus:border-red-400 focus:outline-none focus:shadow-outline-red': errBasePrice }"
              />
            </label>
            <span
              class="text-xs text-red-600 dark:text-red-400"
              x-text="errmBasePrice"
              :class="{'invisible': errBasePrice == false}"
            >
            </span>
          </div>

          <div class="w-full md:w-1/3 md:px-1">
            <label class="block mt-4 text-sm">
              <span class="text-gray-700 dark:text-gray-400">Harga Jual</span>
              <input
                class="block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                placeholder="Harga Jual ke Konsumen"
                x-model="formData.price"
                @keydown.enter="submitData($dispatch)"
                :class="{'border-red-600 focus:border-red-400 focus:outline-none focus:shadow-outline-red': errPrice }"
              />
            </label>
            <span
              class="text-xs text-red-600 dark:text-red-400"
              x-text="errmPrice"
              :class="{'invisible': errPrice == false}"
            >
            </span>
          </div>
        </div>

        <!--
        <div>
          <div class="w-full md:px-1">
            <label class="block mt-4 text-sm">
              <span class="text-gray-700 dark:text-gray-400"
                >Harga Kredit
              </span>
              <div
                class="flex flex-wrap mt-1 relative text-gray-500 focus-within:text-purple-600"
              >
                <input
                  class="block rounded-none rounded-l-sm w-2/12 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                  placeholder="Tenor"
                  x-model="duration"
                  @keydown.enter="addKP($dispatch)"
                />
                <input
                  class="block rounded-none w-10/12 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                  placeholder="Cicilan per bulan"
                  x-model="price"
                  @keydown.enter="addKP($dispatch)"
                />
                <button
                  class="absolute h-full bottom-0 right-0 px-4 text-sm text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-r-sm active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple"
                  @click="addKP($dispatch)"
                >
                  tambah
                </button>
              </div>
            </label>
          </div>

          <dl
            class="w-full whitespace-no-wrap"
            x-show="formData.credit_price.length > 0"
          >
            <div
              class="sm:grid sm:grid-cols-2 text-xs font-semibold tracking-wide text-left text-gray-900 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800"
            >
              <dt class="px-3 py-3">Tenor</dt>
              <dd class="px-3 py-3">Angsuran</dd>
            </div>
            <template
              x-for="(credit, index) in formData.credit_price"
              :key="index"
            >
              <div class="px-4 py-1 sm:grid sm:grid-cols-2">
                <dt
                  class="text-sm leading-5 font-medium text-gray-500"
                  x-text="credit.duration + ' Bulan'"
                ></dt>
                <dd
                  class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
                  x-text="'Rp.' + Number(credit.price).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,').slice(0, -3); + ' / bulan'"
                ></dd>
              </div>
            </template>
          </dl>
        </div>
        -->

        <button
          type="submit"
          class="block w-full px-4 py-2 mt-4 text-sm font-medium leading-5 text-center text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple"
          @click="submitData($dispatch)"
          :disabled="loading == true"
          x-text="loadingText"
          :class="{'cursor-not-allowed opacity-50': loading == true }"
        ></button>
      </div>

      <!--
      <div x-show="orderCreated">
        <div
          class="absolute top-0 mt-4 text-sm md:text-lg font-semibold tracking-wide text-left text-gray-500 uppercase dark:text-gray-400"
          x-text="'Kode #'+product.Code"
        ></div>
        <div
          class="w-full h-48 flex flex-col justify-center items-center"
          :class="{ 'mb-4': photos.length > 1 }"
        >
          <div class="w-full relative">
            <template x-for="(photo, index) in photos" :key="index">
              <div
                x-show="activeSlide === index + 1"
                class="h-48 w-full flex items-center rounded-lg"
              >
                <div class="relative w-full h-full">
                  <img
                    class="object-scale-down w-full h-full"
                    :src="'/file/product/'+photo.Photo"
                    alt=""
                    loading="lazy"
                  />
                  <div
                    class="absolute inset-0 shadow-inner"
                    aria-hidden="true"
                  ></div>
                </div>
              </div>
            </template>
            <div class="absolute inset-0 flex" x-show="photos.length > 1">
              <div class="flex items-center justify-start w-1/2">
                <button
                  class="bg-teal-100 text-teal-500 hover:text-orange-500 font-bold hover:shadow-lg rounded-full w-12 h-12 -ml-6"
                  x-on:click="activeSlide = activeSlide === 1 ? photos.length : activeSlide - 1"
                >
                  &#8592;
                </button>
              </div>
              <div class="flex items-center justify-end w-1/2">
                <button
                  class="bg-teal-100 text-teal-500 hover:text-orange-500 font-bold hover:shadow rounded-full w-12 h-12 -mr-6"
                  x-on:click="activeSlide = activeSlide === photos.length ? 1 : activeSlide + 1"
                >
                  &#8594;
                </button>
              </div>
            </div>
            <div
              class="absolute w-full flex items-center justify-center px-4 mb-4"
              x-show="photos.length > 1"
            >
              <template x-for="(_,index) in photos" :key="index">
                <button
                  class="flex-1 w-4 h-2 mt-4 mx-2 rounded-full overflow-hidden transition-colors duration-200 ease-out hover:bg-teal-600 hover:shadow-lg"
                  :class="{ 
                        'bg-orange-600': activeSlide === index + 1,
                        'bg-teal-300': activeSlide !== index + 1 
                      }"
                  x-on:click="activeSlide = index + 1"
                ></button>
              </template>
            </div>
          </div>
        </div>

        <dl class="w-full whitespace-no-wrap">
          <div
            class="text-xs font-semibold tracking-wide text-left text-gray-900 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800"
          >
            <dt class="px-3 py-3">Informasi Produk</dt>
            <dd class="px-4 sm:px-0"></dd>
          </div>
          <div class="px-4 py-1 sm:grid sm:grid-cols-2">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Nama Barang
            </dt>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-text="product.Name"
            ></dd>
          </div>
          <div class="px-4 py-1 sm:grid sm:grid-cols-2">
            <dt class="text-sm leading-5 font-medium text-gray-500">Brand</dt>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-show="product.Brand != ''"
              x-text="product.Brand"
            ></dd>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-show="product.Brand == ''"
            >
              -
            </dd>
          </div>
          <div class="px-4 py-1 sm:grid sm:grid-cols-2">
            <dt class="text-sm leading-5 font-medium text-gray-500">Tipe</dt>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-show="product.Type != ''"
              x-text="product.Type"
            ></dd>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-show="product.Type == ''"
            >
              -
            </dd>
          </div>
          <div class="px-4 py-1 sm:grid sm:grid-cols-2">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Tanggal Ditambahkan
            </dt>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-text="product.CreatedAt"
            ></dd>
          </div>
        </dl>

        <dl class="w-full whitespace-no-wrap">
          <div
            class="text-xs font-semibold tracking-wide text-left text-gray-900 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800"
          >
            <dt class="px-3 py-3">Harga Produk</dt>
            <dd class="px-4 sm:px-0"></dd>
          </div>
          <div class="px-4 py-1 sm:grid sm:grid-cols-2">
            <dt class="text-sm leading-5 font-medium text-gray-500">Beli</dt>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-text="product.BasePrice"
            ></dd>
          </div>
          <div class="px-4 py-1 sm:grid sm:grid-cols-2">
            <dt class="text-sm leading-5 font-medium text-gray-500">Jual</dt>
            <dd
              class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
              x-text="product.Price"
            ></dd>
          </div>
        </dl>

        <dl class="w-full whitespace-no-wrap" x-show="creditPrice.length > 0">
          <div
            class="text-xs font-semibold tracking-wide text-left text-gray-900 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800"
          >
            <dt class="px-3 py-3">Harga Kredit</dt>
            <dd class="px-4 sm:px-0"></dd>
          </div>
          <template x-for="(credit, index) in creditPrice" :key="index">
            <div class="px-4 py-1 sm:grid sm:grid-cols-2">
              <dt
                class="text-sm leading-5 font-medium text-gray-500"
                x-text="credit.Duration + ' bulan'"
              ></dt>
              <dd
                class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0"
                x-text="credit.Price + ' / Bulan'"
              ></dd></div
          ></template>
        </dl>
        <label class="block mt-4 text-sm">
          <span class="text-blue-700 dark:text-blue-400">
            <a href="#" @click="resetProductForm()" class="text-red-500"
              >Reset</a
            ></span
          >
        </label>
      </div>
      -->
    </div>
  </div>

  <script>
    function create() {
      return {
        formData: {
          customer: 0,
          sales: null,
          surveyor: null,
          collector: null,
          credit: false,
          duration: null,
          notes: "",
        },
        instantData: {
          customer: "",
          sales: "",
          surveyor: "",
          collector: "",
        },
        orderCreated: false,
        tempDataCustomer: {},
        tempDataSales: {},
        tempDataSurveyor: {},
        tempDataCollector: {},
        closeCustomerIS: true,
        closeSalesIS: true,
        closeSurveyorIS: true,
        closeCollectorIS: true,
        customerIS: [],
        salesIS: [],
        surveyorIS: [],
        collectorIS: [],
        loadingText: "Buat Order",
        loading: false,
        duration: null,
        price: null,
        product: [],
        creditPrice: [],
        notifStatus: "",
        errCustomer: false,
        errmCustomer: "",
        errSales: false,
        errmSales: "",
        errSurveyor: false,
        errmSurveyor: "",
        errCollector: false,
        errmCollector: "",
        errDuration: false,
        errmDuration: "",
        errBrand: false,
        errmBrand: "",
        errType: false,
        errmType: "",
        errBasePrice: false,
        errmBasePrice: "",
        errPrice: false,
        errmPrice: "",

        submitData($dispatch) {
          this.loadingText = "Loading...";
          this.loading = true;

          // Jika bukan kredit
          if (this.formData.credit == false) {
            this.formData.duration = null;
          }

          fetch("/api/v1/local/product/add", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(this.formData),
          })
            .then((res) => res.json())
            .then((data) => {
              this.loadingText = "Buat Order";
              this.loading = false;
              if (data.code) {
                this.errCode = true;
                this.errmCode = data.code;
              } else {
                this.errCode = false;
                this.errmCode = "";
              }
              if (data.brand) {
                this.errBrand = true;
                this.errmBrand = data.brand;
              } else {
                this.errBrand = false;
                this.errmBrand = "";
              }
              if (data.type) {
                this.errType = true;
                this.errmType = data.Type;
              } else {
                this.errType = false;
                this.errmType = "";
              }
              if (data.baseprice) {
                this.errBasePrice = true;
                this.errmBasePrice = data.baseprice;
              } else {
                this.errBasePrice = false;
                this.errmBasePrice = "";
              }
              if (data.price) {
                this.errPrice = true;
                this.errmPrice = data.price;
              } else {
                this.errPrice = false;
                this.errmPrice = "";
              }

              if (data.status == "error") {
                this.notifStatus = "error";
              }
              if (data.status == "fail") {
                this.notifStatus = "fail";
              }
              if (data.status == "success") {
                this.notifStatus = "success";
                this.productCreated = true;
                this.product = data.product;
                if (data.product.CreditPrice != null) {
                  this.creditPrice = data.product.CreditPrice;
                } else {
                  this.creditPrice = [];
                }
              }

              if (data.message) {
                $dispatch("notif", {
                  type: this.notifStatus,
                  message: data.message,
                });
              }
            })
            .catch(() => {
              this.loading = false;
              console.log("Telah terjadi kesalahan");
            });
        },
        searchNIK() {
          fetch(
            `/api/v1/local/user/search/ric/10?search=${this.instantData.customer}`,
            {
              method: "GET",
              headers: { "Content-Type": "application/json" },
            }
          )
            .then((res) => res.json())
            .then((data) => {
              if (data.error) {
                $dispatch("notif", {
                  type: "error",
                  message: data.error,
                });
              }
              if (data.users) {
                this.customerIS = data.users;
              } else {
                this.customerIS = [];
              }
            })
            .catch(() => {
              this.loading = false;
              console.log("Telah terjadi kesalahan saat memuat data customer");
            });
        },
        searchSales() {
          fetch(
            `/api/v1/local/user/search/sales/10?search=${this.instantData.sales}`,
            {
              method: "GET",
              headers: { "Content-Type": "application/json" },
            }
          )
            .then((res) => res.json())
            .then((data) => {
              if (data.error) {
                $dispatch("notif", {
                  type: "error",
                  message: data.error,
                });
              }
              if (data.users) {
                this.salesIS = data.users;
              } else {
                this.salesIS = [];
              }
            })
            .catch(() => {
              this.loading = false;
              console.log("Telah terjadi kesalahan saat memuat data sales");
            });
        },
        searchSurveyor() {
          fetch(
            `/api/v1/local/user/search/surveyor/10?search=${this.instantData.surveyor}`,
            {
              method: "GET",
              headers: { "Content-Type": "application/json" },
            }
          )
            .then((res) => res.json())
            .then((data) => {
              if (data.error) {
                $dispatch("notif", {
                  type: "error",
                  message: data.error,
                });
              }
              if (data.users) {
                this.surveyorIS = data.users;
              } else {
                this.surveyorIS = [];
              }
            })
            .catch(() => {
              this.loading = false;
              console.log("Telah terjadi kesalahan saat memuat data surveyor");
            });
        },
        searchCollector() {
          fetch(
            `/api/v1/local/user/search/collector/10?search=${this.instantData.collector}`,
            {
              method: "GET",
              headers: { "Content-Type": "application/json" },
            }
          )
            .then((res) => res.json())
            .then((data) => {
              if (data.error) {
                $dispatch("notif", {
                  type: "error",
                  message: data.error,
                });
              }
              if (data.users) {
                this.collectorIS = data.users;
              } else {
                this.collectorIS = [];
              }
            })
            .catch(() => {
              this.loading = false;
              console.log("Telah terjadi kesalahan saat memuat data collector");
            });
        },
        resetProductForm() {
          this.productCreated = false;
          this.product = [];
          this.formData = {
            name: "",
            code: "",
            brand: "",
            type: "",
            base_price: "",
            price: "",
            credit_price: [],
            photos: [],
          };
          this.photos = [
            {
              ID: 0,
              Photo: "no-photo.png",
            },
          ];
          this.creditPrice = [];
          this.activeSlide = 1;
        },
      };
    }
  </script>
</div>

{{ end }}
