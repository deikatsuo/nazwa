{{ define "dashboard_orders_add_modal_select_product_content" }}
<template x-ref="selectProduct">
  <div x-init="fetchProduct($dispatch)" x-data="product($parent)">
    <!-- Title -->
    <div
      class="absolute top-0 mt-4 text-sm md:text-lg font-semibold tracking-wide text-left text-gray-500 uppercase dark:text-gray-400"
    >
      Pilih produk
    </div>
  </div>
</template>
<script>
  function product($parent) {
    return {
      products: [],
      initProduct($dispatch) {
        var products = document.getElementById("create").__x.$data.products;
        console.log(products);
        if (products.length == 0) {
          this.fetchProduct($dispatch);
        } else {
          this.products = products;
        }
      },
      fetchProduct($dispatch) {
        fetch(`/api/v1/local/product/all`, {
          method: "GET",
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.error) {
              $dispatch("notif", {
                type: "error",
                message: data.error,
              });
            }
            if (data.products) {
              document.getElementById("create").__x.$data.products =
                data.products;
              this.products = data.products;
            }
          })
          .catch(() => {
            console.log("Telah terjadi kesalahan saat memuat data produk");
          });
      },
    };
  }
</script>
{{ end }}
